# View Pic - macOS 图片查看器需求文档

## 项目概述

**项目名称**: View Pic  
**项目描述**: 一款基于 Python 和 Flet 框架开发的 macOS 图片查看应用  
**创建日期**: 2026-01-08  
**版本**: v1.0.0

---

## 技术栈

- **开发语言**: Python 3.12
- **GUI 框架**: Flet
- **包管理工具**: uv
- **目标平台**: macOS 15.3.1 (Apple Silicon M 系列芯片)

---

## 核心需求

### 1. 功能需求

#### 1.1 文件夹导航（左侧面板）
- **需求描述**: 左侧展示当前系统的文件夹树形结构
- **功能点**:
  - 显示用户主目录及子文件夹
  - 支持展开/折叠文件夹
  - 点击文件夹时，右侧展示该文件夹下的所有图片
  - 支持识别外接移动设备（U盘、移动硬盘等）
  - 显示常用位置（桌面、文档、下载、图片等）

#### 1.2 图片展示区域（右侧面板）
- **需求描述**: 右侧展示选中文件夹下的所有图片
- **功能点**:
  - 支持常见图片格式：JPG, JPEG, PNG, GIF, BMP, WEBP, HEIC
  - 两种展示模式：
    - **列表模式**: 显示图片名称、大小、修改日期等信息
    - **缩略图模式**: 以网格形式展示图片缩略图
  - 点击图片可以预览大图

#### 1.3 缩略图自适应布局
- **需求描述**: 缩略图模式下，窗口大小变化时自动调整布局
- **功能点**:
  - 窗口宽度增加时，每行展示的图片数量增加
  - 窗口宽度减少时，每行展示的图片数量减少
  - 保持图片比例不变形
  - 流式布局，自动换行

#### 1.4 移动设备识别
- **需求描述**: 自动识别外接的移动存储设备
- **功能点**:
  - 监听 /Volumes 目录下的设备挂载
  - 在左侧文件夹树中显示移动设备
  - 支持访问移动设备中的图片

---

### 2. 界面设计需求

#### 2.1 整体布局
```
┌─────────────────────────────────────────────┐
│  [应用标题栏]                               │
├──────────────┬──────────────────────────────┤
│              │                              │
│   文件夹树   │      图片展示区域            │
│   (左侧)     │      (右侧)                  │
│              │                              │
│              │  [列表/缩略图切换按钮]       │
│              │                              │
└──────────────┴──────────────────────────────┘
```

#### 2.2 设计风格
- **美观**: 采用现代化 UI 设计
- **大方**: 布局合理，留白适当
- **简洁**: 功能清晰，无冗余元素
- **现代化**: 使用圆角、阴影、渐变等现代设计元素

#### 2.3 色彩方案
- 主色调：浅蓝色 (#E3F2FD)
- 辅助色：白色 (#FFFFFF)
- 强调色：深蓝色 (#1976D2)
- 文字色：深灰色 (#333333)
- 边框色：浅灰色 (#E0E0E0)

---

## 非功能性需求

### 3.1 性能需求
- 图片加载速度：缩略图加载时间 < 1秒
- 大图预览响应时间 < 500ms
- 支持大量图片（1000+）的流畅浏览

### 3.2 兼容性需求
- 适配 macOS 15.3.1
- 支持 Apple Silicon (M 系列芯片)
- 支持 Retina 高分辨率显示

### 3.3 用户体验需求
- 界面响应流畅，无卡顿
- 操作直观，无需学习成本
- 支持键盘快捷键（可选）

---

## 实现计划

### 阶段一：基础框架搭建
1. 配置项目依赖（flet）
2. 创建主窗口和基础布局
3. 实现左右分栏结构

### 阶段二：核心功能开发
1. 实现文件夹树形结构
2. 实现图片扫描和展示
3. 实现列表/缩略图切换
4. 实现缩略图自适应布局

### 阶段三：高级功能开发
1. 实现移动设备识别
2. 实现大图预览
3. 性能优化（懒加载、缓存等）

### 阶段四：UI 优化
1. 美化界面样式
2. 添加动画效果
3. 优化用户交互体验

### 阶段五：测试与发布
1. 功能测试
2. 性能测试
3. 用户体验测试
4. 打包发布

---

## 技术难点与解决方案

### 难点 1：移动设备识别
**解决方案**: 
- macOS 下监听 `/Volumes` 目录
- 使用 `os.listdir()` 或 `pathlib` 获取挂载的设备
- 定时或使用文件系统监听 API 检测设备变化

### 难点 2：缩略图自适应布局
**解决方案**: 
- 使用 Flet 的 `GridView` 或 `Row/Column` 动态计算列数
- 监听窗口 `resize` 事件
- 根据窗口宽度动态调整每行图片数量

### 难点 3：大量图片性能优化
**解决方案**: 
- 懒加载：只加载可见区域的图片
- 缩略图缓存：生成缩略图并缓存
- 虚拟滚动：只渲染可见区域的元素

---

## 参考资料

- [Flet 官方文档](https://flet.dev/)
- [Python PIL/Pillow 图像处理](https://pillow.readthedocs.io/)
- macOS 文件系统 API

---

## 变更记录

| 版本 | 日期 | 变更内容 | 作者 |
|------|------|----------|------|
| v1.0.0 | 2026-01-08 | 初始版本，定义核心需求 | AI Assistant |

---

**备注**: 本文档将随着项目开发进度持续更新，所有重要变更都会记录在变更记录中。
